<main>
  <section class="section">
    <div class="content-block">
      <h1 class="page-title">{{ getTranslation('posts.allPosts') }}</h1>
      <p class="page-subtitle">{{ getTranslation('posts.allPostsSubtitle') }}</p>

      <div class="search-filters">

        <div class="filters-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ getTranslation('posts.searchPosts') }}</mat-label>
            <input matInput [(ngModel)]="searchQuery" (input)="onSearchChange($any($event.target).value)" [placeholder]="getTranslation('posts.searchPlaceholder')">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ getTranslation('filters.category') }}</mat-label>
            <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onCategoryChange($event.value)">
              <mat-option value="">{{ getTranslation('categories.allCategories') }}</mat-option>
              <mat-option value="Vocabulary">{{ getTranslation('categories.vocabulary') }}</mat-option>
              <mat-option value="Grammar">{{ getTranslation('categories.grammar') }}</mat-option>
              <mat-option value="Business">{{ getTranslation('categories.business') }}</mat-option>
              <mat-option value="Travel">{{ getTranslation('categories.travel') }}</mat-option>
              <mat-option value="IT">{{ getTranslation('categories.it') }}</mat-option>
              <mat-option value="Medical">{{ getTranslation('categories.medical') }}</mat-option>
              <mat-option value="Academic">{{ getTranslation('categories.academic') }}</mat-option>
              <mat-option value="Conversation">{{ getTranslation('categories.conversation') }}</mat-option>
              <mat-option value="Kids">{{ getTranslation('categories.kids') }}</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ getTranslation('filters.level') }}</mat-label>
            <mat-select [(ngModel)]="selectedLevel" (selectionChange)="onLevelChange($event.value)">
              <mat-option value="">{{ getTranslation('levels.allLevels') }}</mat-option>
              <mat-option value="A1_A2">{{ getTranslation('levels.a1_a2') }}</mat-option>
              <mat-option value="B1_B2">{{ getTranslation('levels.b1_b2') }}</mat-option>
              <mat-option value="C1_C2">{{ getTranslation('levels.c1_c2') }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      @if (loading) {
        <div class="loading">
          <p>{{ getTranslation('posts.loadingPosts') }}</p>
        </div>
      } @else if (error) {
        <div class="error">
          <p>{{ getTranslation('posts.errorLoadingPosts') }}</p>
          <button mat-raised-button color="primary" (click)="loadPosts()">{{ getTranslation('common.retry') }}</button>
        </div>
      } @else if (posts.length === 0) {
        <div class="empty">
          <p>{{ getTranslation('posts.noPostsFound') }}</p>
        </div>
      } @else {
        <div class="grid grid-3 posts-grid">
          @for (post of posts; track post) {
            <app-post-card [post]="post"></app-post-card>
          }
        </div>

        @if (totalPages > 1) {
          <app-pagination
            [currentPage]="page"
            [totalPages]="totalPages"
            (pageChange)="onPageChange($event)">
          </app-pagination>
        }
      }
    </div>
  </section>

  <section class="section subscribe-section">
    <app-subscribe></app-subscribe>
  </section>
</main>
